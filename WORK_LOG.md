# CAFA6 作業ログ

最終更新: 2026-02-02

## 現在のベスト
- **0.387** (SOTA+ESM2 merged)

## 提出履歴（実際のLBスコアあり）

| ファイル | 行数(M) | mean | >=0.9(M) | 予測LB | 実際LB | 差 |
|---------|--------|------|----------|--------|--------|-----|
| merged_sota_esm2_386_new | 53.3 | 0.329 | 10.5 | 0.375 | **0.387** | +0.012 |
| merged_sota_esm2_386_new | 53.3 | 0.329 | 10.5 | 0.375 | 0.386 | +0.011 |
| max_sota_antonoof | 58.6 | 0.347 | 12.8 | 0.364 | **0.381** | +0.017 |
| blend_sota95_taxon5 | 53.3 | 0.313 | 10.4 | 0.385 | **0.368** | -0.017 |

## 全ファイル統計

| ファイル | 行数(M) | mean | >=0.9(M) | 予測LB |
|---------|--------|------|----------|--------|
| 4model_merge | 52.1 | 0.337 | 10.3 | 0.370 |
| 5model_geometric | 52.1 | 0.333 | 10.3 | 0.373 |
| 5model_merge | 52.1 | 0.337 | 10.3 | 0.371 |
| antonoof_optimization | 58.3 | 0.344 | 12.6 | 0.366 |
| blend_easy90_hard_max_p80 | 53.3 | 0.318 | 10.5 | 0.382 |
| blend_easy90_hard_max_p85 | 53.3 | 0.312 | 8.6 | 0.386 |
| blend_easy90_hard_max_p90 | 53.3 | 0.307 | 6.5 | 0.389 |
| blend_easy95_hard_max_p85 | 53.3 | 0.321 | 10.4 | 0.381 |
| blend_max90_taxon10 | 58.6 | 0.314 | 8.1 | 0.385 |
| blend_sota90_taxon9 | 53.3 | 0.297 | 6.5 | 0.395 |
| blend_sota91_taxon8 | 53.3 | 0.300 | 8.5 | 0.393 |
| blend_sota92_taxon7 | 53.3 | 0.304 | 10.2 | 0.391 |
| blend_sota95_taxon5 | 53.3 | 0.313 | 10.4 | 0.385 |
| geometric_mean_new | 53.3 | 0.329 | 10.5 | 0.375 |
| max_sota_antonoof | 58.6 | 0.347 | 12.8 | 0.364 |
| merged_sota_esm2_386_new | 53.3 | 0.329 | 10.5 | 0.375 |
| rank_ensemble_propagated | 56.8 | 0.337 | 4.8 | 0.370 |
| triple_50_40_10 | 58.6 | 0.288 | 6.4 | 0.401 |

## 現在の予測式

```
LB ≈ -0.622 * mean + 0.580
```

**問題点:**
- 今日の提出で±0.017の誤差
- 高スコア数(>=0.9)を考慮していない
- blend_sota95_taxon5は予測より0.017悪い
- max_sota_antonoofは予測より0.017良い

## 予測式の改善に必要なデータ

もっと実際のLBスコアが必要。現状4データポイントのみ。

## 主要スクリプト

| パス | 用途 |
|------|------|
| scripts/validate_submission.py | 提出前検証 |
| scripts/merge_submissions.py | ファイルマージ |
| scripts/max_merge.py | max合成 |
| scripts/safe_blend.py | 安全なブレンド |

## 学んだこと

1. **混ぜると悪化する** - 100+実験ノートブックでも確認
2. **高スコア数(>=0.9)が重要** - 1M未満は0.14x確定
3. **現在の回帰式は不正確** - 高スコア数を考慮していない
4. **SOTA単体が最強** - 0.387を超えられていない

## 残り提出

2回

---

## 予測式の改善 (2026-02-02)

### 新しい予測式（暫定）



**精度比較:**
| 式 | MAE |
|----|-----|
| 旧式 (meanのみ) | 0.0062 |
| 新式 (mean+high) | 0.0003 |

### 新式での予測

| ファイル | mean | high(M) | 新予測 | 実際 | 差 |
|---------|------|---------|--------|------|-----|
| merged_sota_esm2 | 0.329 | 10.5 | 0.387 | 0.387 | 0.000 |
| max_sota_antonoof | 0.347 | 12.8 | 0.381 | 0.381 | 0.000 |
| blend_sota95_taxon5 | 0.313 | 10.4 | 0.368 | 0.368 | 0.000 |

### 注意

- 4データポイントのみ → 過学習の可能性
- 追加提出でデータを増やして検証が必要
- 高スコア数が増えるとLB下がる？ → 直感に反する、要調査

---

## 全20件分析結果 (2026-02-02)

### カテゴリ別パターン

| カテゴリ | 件数 | 平均 | 範囲 |
|---------|------|------|------|
| baseline | 5 | 0.141 | 0.140-0.141 |
| weighted top-N | 3 | 0.283 | 0.279-0.291 |
| ensemble | 3 | 0.361 | 0.356-0.364 |
| single | 3 | 0.375 | 0.362-0.386 |
| sota_blend | 6 | 0.382 | 0.368-0.387 |

### 確定ルール

1. **baseline使用 → 0.14x確定 (提出禁止)**
2. **weighted avg + top-N → 0.28x (低スコア警告)**
3. **ensemble → 0.35-0.39**
4. **sota_blend/single → 0.36-0.39**

### 検証フロー


